@import net.prover.model.proof.ProofLine.Expression
@import net.prover.model.HtmlHelper
@(expression: Expression, safe: Boolean = false)
@expression match {
  case Expression.Plain(text, referrers) => {<span class="@referrers.map("highlight-" + _).mkString(" ")">@Html(HtmlHelper.format(text))</span>}
  case Expression.Nested(definitionFormat, boundVariableNames, components, referrers) => {
    <span class="@referrers.map("highlight-" + _).mkString(" ")">@Html(definitionFormat.apply(
      boundVariableNames.map(HtmlHelper.format) ++ components.map(html.expression.apply(_, true).body.trim()),
      safe
    ))</span>}
  case _ => {}
}