@import net.prover.model.entries.Theorem
@import net.prover.model.proof.ReferenceMap
@import net.prover.model.{Book, Chapter, DisplayContext, Inference}
@import net.prover.viewmodel.Breadcrumb
@(
  description: String,
  inference: Inference.Entry,
  referenceMap: ReferenceMap,
  chapter: Chapter,
  book: Book,
  previousOption: Option[Inference.Entry],
  nextOption: Option[Inference.Entry],
  usages: Seq[(Book, Chapter, Seq[Theorem])])(
  content: Html)(
  implicit displayContext: DisplayContext)

@html.main(Seq(Breadcrumb.Root, Breadcrumb.Book(book), Breadcrumb.Chapter(chapter), Breadcrumb.Inference(inference))) {
  <div class="inference">
    <div class="inferenceLinks">
      @previousOption.map { previous =>
        <a class="inferenceLink pull-left" href="/books/@book.key/@chapter.key/@previous.key">&laquo; @previous.name</a>
      }
      @nextOption.map { next =>
        <a class="inferenceLink pull-right" href="/books/@book.key/@chapter.key/@next.key">@next.name &raquo;</a>
      }
    </div>

    <div class="inferenceTitle">
      <h3>
        @description: @inference.name
      </h3>
      <div class="inferenceId">
        @inference.id
      </div>
    </div>

    <p>
      @html.premises(inference.premises, referenceMap)
      <div>
        @if(inference.premises.nonEmpty) { Then } @html.expression(inference.conclusion).
      </div>
    </p>

    @content

    @if(usages.nonEmpty) {
      <hr />
      @for((usageBook, usageChapter, inferences) <- usages) {
        <div><label>@usageBook.title - @usageChapter.title</label></div>
        <p>
        @for(inference <- inferences) {
          <span class="usage">
            <a class="usageLink" href="/books/@usageBook.key/@usageChapter.key/@inference.key">@inference.name</a>
          </span>
        }
        </p>
      }
    }
  </div>
}
