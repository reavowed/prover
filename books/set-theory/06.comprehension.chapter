Introduce set comprehension, {x ∈ A | φ(x)}.

theorem Comprehensions Exist for Empty Sets
statementVariables(φ 1)
termVariables(A 0)
premise ¬ ∃ x ∧ ∈ $0 t0 with ($0) s0
conclusion ∃! y ∀ x ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0
{
  prove ∀ x ¬ ∧ ∈ $0 t0 with ($0) s0 e324cf1b7d57c0bced47a61afd2278eb487178017eddc32eff8a035fcb7da9b7 (∧ ∈ $0 t0 with ($0) s0) () p0
  prove ∀ x ¬ ∈ $0 ∅ d72e10372d8a1ee2e0f947c54069ce256ea3b40090f16d222a270b6d01a23ba0 () ()
  elided 969fe999e4d5d620af12493d29f784dc121d217aee403848a602e7dbae723076 {
    take x {
      prove ¬ ∈ $0 ∅ b501ae82c9cd785ac59610aad18f8065a5643b29c10ad4d5821c383cbf7cd34f (¬ ∈ $$0 ∅) ($0) 1
      prove ¬ ∧ ∈ $0 t0 with ($0) s0 b501ae82c9cd785ac59610aad18f8065a5643b29c10ad4d5821c383cbf7cd34f (¬ ∧ ∈ $$0 t0 with ($$0) s0) ($0) 0
      prove ↔ ∈ $0 ∅ ∧ ∈ $0 t0 with ($0) s0 969fe999e4d5d620af12493d29f784dc121d217aee403848a602e7dbae723076 (∈ $0 ∅, ∧ ∈ $0 t0 with ($0) s0) () 2.0.0 2.0.1
    }
  }
  prove ∃ y ∀ x ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 0de244e67f8bd3b7ed1f30bff6577fb62d16c4e035fb38e91455fabc625f43f2 (∀ x ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0) (∅) 2
  prove ∃! y ∀ x ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 288a339c30f6b561d0a86d8a4ad51c2acccaa964cc586fd001f47dde466ba92c (∧ ∈ $0 t0 with ($0) s0) () 3
}

theorem Comprehensions Exist for Non-Empty Sets Lemma
statementVariables(φ 1)
termVariables(a 0, A 0)
premise ∧ ∈ t0 t1 with (t0) s0
conclusion ∀ y ↔ ∃ x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 ∧ ∈ $0 t1 with ($0) s0
{
  take y {
    assume ∃ x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 {
      let x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 30412315b8eb88fa8dd1fa23362d9aea6a428afe70be747bb9e02eea9ec6b3f7 (∧ ∈ $$0 t1 ∨ ∧ with ($$0) s0 = $0 $$0 ∧ ¬ with ($$0) s0 = $0 t0, ∧ ∈ $0 t1 with ($0) s0) () {
        assume with ($0) s0 {
          elided bd93bc362ef83f27bde9771b3d7af1487bb0716344107ffcd84a766693502be1 {
            prove ¬ ¬ with ($0) s0 3df4534886dd61f6ef0a8462fb7cdbff93a3381c7b5ce4d4871f1d25450b688a (with ($0) s0) () 0.0.0.0a
            prove ↔ ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 = $$0 $0 bd93bc362ef83f27bde9771b3d7af1487bb0716344107ffcd84a766693502be1 (with ($0) s0, ¬ with ($0) s0, = $$0 $0, = $$0 t0) () 0.0.0.0a 0.0.0.0.0.0
          }
          elided 00f52187d02fb3be4132cd306e1d837f6d5c90acd4e3ff73fc02416356b758b4 {
            prove → ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 = $$0 $0 3dee2da91a324273fff20924f29a7df9b6388f1f48ae09e93b292e42b3546ae7 (∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0, = $$0 $0) () 0.0.0.0.0
            prove = $$0 $0 00f52187d02fb3be4132cd306e1d837f6d5c90acd4e3ff73fc02416356b758b4 (∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0, = $$0 $0) () 0.0.0.0.1.0 0.0.0a 062123718abc1909811caf4720d2507f5265f54ca9003f4bda14c8d757d44a29
          }
          prove ∧ ∈ $0 t1 with ($0) s0 301900ba992fe47a3f300cf9f14f0fd6a948ca32c488285b6f4cf2d02efc3a61 (∈ $0 t1, with ($0) s0) () 0.0.0a 827ecc2b1b19ca976022860dade4c605eef6eb2908bc2934591a9a8abf32ab5a 0.0.0.0a
          prove ∧ ∈ $$0 t1 with ($$0) s0 2f09d05868429e1af035bd8050cb3d39de6550c92033f6fbc9deaa3a929b7b09 (∧ ∈ $$$0 t1 with ($$$0) s0) ($$0, $0) 0.0.0.0.1 0.0.0.0.2
        }
        assume ¬ with ($0) s0 {
          prove ↔ ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 = $$0 t0 5aab6ca759237c74f7c83672e9a60b1e04fd164457bc51b95ed496fa53c75694 (with ($0) s0, ¬ with ($0) s0, = $$0 $0, = $$0 t0) () 0.0.0.1a 0.0.0.1a
          elided 00f52187d02fb3be4132cd306e1d837f6d5c90acd4e3ff73fc02416356b758b4 {
            prove → ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 = $$0 t0 3dee2da91a324273fff20924f29a7df9b6388f1f48ae09e93b292e42b3546ae7 (∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0, = $$0 t0) () 0.0.0.1.0
            prove = $$0 t0 00f52187d02fb3be4132cd306e1d837f6d5c90acd4e3ff73fc02416356b758b4 (∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0, = $$0 t0) () 0.0.0.1.1.0 0.0.0a 062123718abc1909811caf4720d2507f5265f54ca9003f4bda14c8d757d44a29
          }
          prove ∧ ∈ $$0 t1 with ($$0) s0 2f09d05868429e1af035bd8050cb3d39de6550c92033f6fbc9deaa3a929b7b09 (∧ ∈ $$$0 t1 with ($$$0) s0) ($$0, t0) 0.0.0.1.1 p0
        }
        prove ∧ ∈ $$0 t1 with ($$0) s0 12afb9df21eda1ecba39f95a0b7af6e3087951e80382722b0e143de0e3443389 (with ($0) s0, ∧ ∈ $$0 t1 with ($$0) s0) () 0.0.0.0 0.0.0.1
      } 0.0a
    }
    assume ∧ ∈ $0 t1 with ($0) s0 {
      prove = $0 $0 12132c1c387352ed15f80fb5954b5d7a80c2cb58f6f290f43d9b4417b54bc465 () ($0)
      elided 301900ba992fe47a3f300cf9f14f0fd6a948ca32c488285b6f4cf2d02efc3a61 {
        prove ∧ with ($0) s0 = $0 $0 301900ba992fe47a3f300cf9f14f0fd6a948ca32c488285b6f4cf2d02efc3a61 (with ($0) s0, = $0 $0) () 0.1a 062123718abc1909811caf4720d2507f5265f54ca9003f4bda14c8d757d44a29 0.1.0
        prove ∨ ∧ with ($0) s0 = $0 $0 ∧ ¬ with ($0) s0 = $0 t0 6ccfde38da3fbc5937d0be48df56b30e7fce440242958bd0ca09d3eb86c6fda3 (∧ with ($0) s0 = $0 $0, ∧ ¬ with ($0) s0 = $0 t0) () 0.1.1.0
        prove ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $0 $0 ∧ ¬ with ($0) s0 = $0 t0 301900ba992fe47a3f300cf9f14f0fd6a948ca32c488285b6f4cf2d02efc3a61 (∈ $0 t1, ∨ ∧ with ($0) s0 = $0 $0 ∧ ¬ with ($0) s0 = $0 t0) () 0.1a 827ecc2b1b19ca976022860dade4c605eef6eb2908bc2934591a9a8abf32ab5a 0.1.1.1
      }
      prove ∃ x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 0de244e67f8bd3b7ed1f30bff6577fb62d16c4e035fb38e91455fabc625f43f2 (∧ ∈ $$0 t1 ∨ ∧ with ($$0) s0 = $0 $$0 ∧ ¬ with ($$0) s0 = $0 t0) ($0) 0.1.1
    }
    prove ↔ ∃ x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0 ∧ ∈ $0 t1 with ($0) s0 df9994032af3276a9a030eb7b809e059dd53a14d6de2e12273242729e90a2a91 (∃ x ∧ ∈ $0 t1 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 t0, ∧ ∈ $0 t1 with ($0) s0) () 0.0 0.1
  }
}

theorem Comprehensions Exist for Non-Empty Sets
statementVariables(φ 1)
termVariables(A 0)
premise ∃ y ∧ ∈ $0 t0 with ($0) s0
conclusion ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0
{
  let a ∧ ∈ $0 t0 with ($0) s0 30412315b8eb88fa8dd1fa23362d9aea6a428afe70be747bb9e02eea9ec6b3f7 (∧ ∈ $0 t0 with ($0) s0, ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0) () {
    take x {
      prove ∃! y ∨ ∧ with ($$0) s0 = $0 $$0 ∧ ¬ with ($$0) s0 = $0 $$$0 87f6070529ebc545256e9deb3d6e2f7f95966f7d6433960bfb43502e1ed1f89c (with ($0) s0) ($0, $$0)
      prove → ∈ $0 t0 ∃! y ∨ ∧ with ($$0) s0 = $0 $$0 ∧ ¬ with ($$0) s0 = $0 $$$0 acbe547cc61228898842cf6a8732b10d52cf1f493dd2455a7cecc64235f53854 (∃! y ∨ ∧ with ($$0) s0 = $0 $$0 ∧ ¬ with ($$0) s0 = $0 $$$0, ∈ $0 t0) () 0.0.0
    }
    prove ∃! x ∀ y ↔ ∈ $0 $$0 ∃ x ∧ ∈ $0 t0 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 $$$$0 b9824fd6f00092a866dd6293c23a983e93e0ddf13a433df477ab83cd6fbf83fa (∨ ∧ with ($$0) s0 = $$1 $$0 ∧ ¬ with ($$0) s0 = $$1 $0) (t0) 0.0
    prove ∀ y ↔ ∃ x ∧ ∈ $0 t0 ∨ ∧ with ($0) s0 = $$0 $0 ∧ ¬ with ($0) s0 = $$0 $$$0 ∧ ∈ $0 t0 with ($0) s0 bbefb146f9fe36f8ec14cbd5140e7f95d8305f7b934f41c34d1e5221dcd85d26 (with ($$0) s0) ($0, t0) 0a
    prove ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 8ae8122d854da1474bddaf18a318cb348535112ca944d8e70f9ebf555a97ed2e (∃ x ∧ ∈ $0 t0 ∨ ∧ with ($0) s0 = $$$0 $0 ∧ ¬ with ($0) s0 = $$$0 $$0, ∧ ∈ $$0 t0 with ($$0) s0) () 0.1 0.2
  } p0
}

theorem Comprehensions Exist
statementVariables(φ 1)
termVariables(X 0)
conclusion ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0
{
  assume ¬ ∃ y ∧ ∈ $0 t0 with ($0) s0 {
    prove ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 a2e359e0255d7d6ae9b4ff03cf70607190e8d4458a95454971b7b106dd8ce3fb (with ($0) s0) (t0) 0a
  }
  assume ∃ y ∧ ∈ $0 t0 with ($0) s0 {
    prove ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 6ca18706a301e5c0143f8dd6b6320095e831fe6c2f03739678b458208e72cf80 (with ($0) s0) (t0) 1a
  }
  prove ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0 12afb9df21eda1ecba39f95a0b7af6e3087951e80382722b0e143de0e3443389 (∃ y ∧ ∈ $0 t0 with ($0) s0, ∃! Y ∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0) () 1 0
}

term comprehension ($x A with x φ)
  name (Comprehension)
  format ({ x ∈ A | φ }) no-component-brackets
  (∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t0 with ($0) s0)

theorem Membership Condition for a Comprehension
statementVariables(φ 1)
termVariables(S 0, A 0)
premise = t0 comprehension x t1 with ($0) s0
conclusion ∀ y ↔ ∈ $0 t0 ∧ ∈ $0 t1 with ($0) s0
{
  prove ∀ y ↔ ∈ $0 comprehension x t1 with ($0) s0 ∧ ∈ $0 t1 with ($0) s0 75d843010d923f185d0c6260204d038d28a6e82a4fed04ce7c3d27acd454bb56 (with ($0) s0) (t1)
  prove ∀ y ↔ ∈ $0 t0 ∧ ∈ $0 t1 with ($0) s0 2f09d05868429e1af035bd8050cb3d39de6550c92033f6fbc9deaa3a929b7b09 (∀ y ↔ ∈ $0 $$0 ∧ ∈ $0 t1 with ($0) s0) (t0, comprehension x t1 with ($0) s0) p0 0
}

theorem A Comprehension Is a Subset of Its Domain
statementVariables(φ 1)
termVariables(S 0, A 0)
premise = t0 comprehension x t1 with ($0) s0
conclusion ⊆ t0 t1
{
  take y {
    assume ∈ $0 t0 {
      elided 6182c4f89ff3e95edcf4678ad5622f078eb321080692cb692a77dd4080579754 {
        prove ∀ y ↔ ∈ $0 t0 ∧ ∈ $0 t1 with ($0) s0 6182c4f89ff3e95edcf4678ad5622f078eb321080692cb692a77dd4080579754 (with ($$0) s0) (t0, t1) p0
        prove ↔ ∈ $0 t0 ∧ ∈ $0 t1 with ($0) s0 b501ae82c9cd785ac59610aad18f8065a5643b29c10ad4d5821c383cbf7cd34f (↔ ∈ $$0 t0 ∧ ∈ $$0 t1 with ($$0) s0) ($0) 0.0.0.0
        prove → ∈ $0 t0 ∧ ∈ $0 t1 with ($0) s0 3dee2da91a324273fff20924f29a7df9b6388f1f48ae09e93b292e42b3546ae7 (∈ $0 t0, ∧ ∈ $0 t1 with ($0) s0) () 0.0.0.1
        prove ∧ ∈ $0 t1 with ($0) s0 00f52187d02fb3be4132cd306e1d837f6d5c90acd4e3ff73fc02416356b758b4 (∈ $0 t0, ∧ ∈ $0 t1 with ($0) s0) () 0.0.0.2 0.0a
        prove ∈ $0 t1 827ecc2b1b19ca976022860dade4c605eef6eb2908bc2934591a9a8abf32ab5a (∈ $0 t1, with ($0) s0) () 0.0.0.3
      }
    }
  }
  prove ⊆ t0 t1 ec7fc0729669e6268d01ee93cfc031e0baa57e3a4871bcbc82ca754bc591f204 () (t0, t1) 0
}
